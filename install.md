# Installation Guide

To set up the application, ensure Python 3.x and Node.js with npm are installed. Clone the project repository and navigate to the directory. This script will validate the YAML file, generate an HTML page, and create a PNG diagram. For troubleshooting, check YAML validation errors, missing dependencies, or ensure `mermaid-cli` is accessible in your PATH.

## 1. Prerequisites

Before installing the application, ensure that the following tools are available on your system:

1. **Python 3.x**:
   - Download and install from [python.org](https://www.python.org/downloads/).
   
2. **Node.js and npm**:
   - Download and install from [nodejs.org](https://nodejs.org/).
   - This is required for installing the Mermaid CLI.

## 2. Install the Required Libraries

The application relies on several Python libraries and the `mermaid-cli` tool. Follow these steps to install them:

### 2.1 Clone the Repository

If you have a GitHub repository for this project, clone it to your local machine:

```bash
git clone <repository-url>
cd <repository-directory>
```

If not, make sure all the necessary files (`diagram_processor.py`, `diagram.schema.json`, `page.schema.json`, and `requirements.txt`) are in a local folder.

### 2.2 Install Python Dependencies

Open a terminal in the project directory and run the following command to install the required Python packages:

```bash
pip install -r requirements.txt
```

### 2.3 Install Mermaid CLI Using npm

Mermaid is a tool for rendering diagrams from text descriptions. You'll need to install it globally using npm:

```bash
npm install -g @mermaid-js/mermaid-cli
```

This command installs the `mermaid-cli` tool, which is used to render diagrams as PNG files.

#### Verify `mermaid-cli` Installation
Check if `mermaid-cli` is correctly installed by running:

```bash
mmdc -h
```

## 3. Running the Application

Once all the dependencies are installed, you can run the script with a sample YAML file.

### 3.1 Command to Run the Script

```bash
python diagram_processor.py example_diagram.yml
```

This command processes the `example_diagram.yml` file, validates it against the provided schemas, generates an HTML file, and renders the diagram as a PNG image.

### 3.2 Expected Output

If the YAML file is valid, you should see two new files generated:

1. `example_diagram.html`: The HTML page created from the YAML content.
2. `Vehicle Class Diagram.png`: The rendered diagram image generated by Mermaid.

### 3.3 Troubleshooting

If you encounter any issues, check the following:

- **YAML Validation Errors**: Ensure that the YAML file structure conforms to the specified schemas (`page.schema.json` and `diagram.schema.json`).
- **Mermaid CLI Not Found**: Make sure that `mermaid-cli` was installed globally and is accessible in your system's PATH.
- **Missing Dependencies**: If any Python modules are missing, reinstall the dependencies using the `requirements.txt` file.

## 4. Project Structure

Ensure your project files are organized as follows:

```
project/
├── diagram_processor.py          # Python script for processing YAML and generating HTML
├── diagram.schema.json           # JSON Schema for validating the diagram structure
├── page.schema.json              # JSON Schema for validating the HTML page structure
├── example_diagram.yml           # Example YAML file to test the script
├── requirements.txt              # Python dependencies file
├── install.md                    # Installation guide (this file)
└── authoring_guide.md            # Guide for creating YAML files
```

## 5. Sample Diagram for Testing

A sample `example_diagram.yml` is provided for testing. Refer to the [Authoring Guide](./authoring_guide.md) for more details on how to create your own YAML files for this application.


Updating Node.js inside a virtual environment on Windows 11 requires a slightly different approach because Node.js is typically not installed in virtual environments like Python. However, if you want to update Node.js specifically for your project without affecting the global Node.js installation, you can use a Node.js version manager such as `nvm` or manually update Node.js for your local project.

### Step 1: Using `nvm` (Node Version Manager)
`nvm` allows you to manage and update Node.js versions locally without affecting the global installation. This is useful when working in isolated development environments.

1. **Install `nvm` for Windows**:
   - Download `nvm-setup.zip` from the [NVM for Windows GitHub repository](https://github.com/coreybutler/nvm-windows/releases).
   - Run the installer and follow the instructions to install `nvm`.

2. **Verify `nvm` Installation**:
   After installation, open a new command prompt and check the version:

   ```bash
   nvm version
   ```

3. **Install the Desired Node.js Version**:
   Use `nvm` to install the Node.js version you want. For example, to install the latest stable release:

   ```bash
   nvm install latest
   ```

   Alternatively, you can specify a specific version like this:

   ```bash
   nvm install 16.13.0
   ```

4. **Switch to the Installed Version**:
   After installing, you need to tell `nvm` which version of Node.js to use in your current session:

   ```bash
   nvm use latest
   ```

5. **Verify the Node.js and npm Versions**:
   After switching, confirm that the correct version is active:

   ```bash
   node -v
   npm -v
   ```

**Using `nvm` inside a Virtual Environment:**
If you want to use a specific version inside a virtual environment, create a separate folder for the environment and switch to that Node.js version using `nvm use` whenever you activate the environment.

### Step 2: Manually Updating Node.js for a Project
If you’re not using `nvm`, you can manually update Node.js for your local project using the following approach:

1. **Navigate to Your Project Directory**:
   Open a command prompt and change to the project directory:

   ```bash
   cd path\to\your\project
   ```

2. **Download the Latest Node.js Version**:
   Go to the [Node.js Downloads page](https://nodejs.org/en/download/) and download the Windows 64-bit `.zip` file for the desired Node.js version.

3. **Extract Node.js Locally**:
   Extract the downloaded `.zip` file to a folder inside your project directory, such as `.\node-v16.13.0-win-x64`.

4. **Update the Local Path**:
   Modify your project’s `PATH` environment variable to include the extracted Node.js folder.

   For example, add this path:

   ```
   .\node-v16.13.0-win-x64\
   ```

5. **Verify Local Node.js Version**:
   Open a new command prompt, navigate to your project directory, and check the version:

   ```bash
   .\node-v16.13.0-win-x64\node -v
   ```

   This command should output the version of Node.js you downloaded, indicating that the local version is being used.

### Step 3: Update Node.js Using `npx` in a Virtual Environment
If you want to update Node.js without installing `nvm`, you can use `npx` to temporarily use a different Node.js version for your project:

1. **Use `npx` to Run Node.js**:
   Navigate to your project directory and use `npx` to specify the version of Node.js:

   ```bash
   npx node@16.13.0 index.js
   ```

   This command will use Node.js version 16.13.0 to run `index.js` without affecting the globally installed Node.js version.

### Step 4: Create a Node.js Virtual Environment Using `nodeenv`
If you want a more Python-style virtual environment for Node.js, you can use the `nodeenv` package, which works similarly to `venv` in Python.

1. **Install `nodeenv` Globally**:

   First, install `nodeenv` using `pip`:

   ```bash
   pip install nodeenv
   ```

2. **Create a Node.js Virtual Environment**:

   Create a Node.js virtual environment in your project directory:

   ```bash
   nodeenv env
   ```

3. **Activate the Virtual Environment**:

   Activate the environment:

   ```bash
   .\env\Scripts\activate
   ```

4. **Update Node.js Inside the Virtual Environment**:

   Once the environment is active, you can update Node.js inside it using:

   ```bash
   npm install --location=global npm@latest
   ```

### Step 5: Verify the Installed Version Inside the Virtual Environment

After updating, confirm that Node.js is updated by running:

```bash
node -v
npm -v
```

### Summary
- Use `nvm` for Windows to manage Node.js versions locally and switch between them.
- Manually extract and configure a specific Node.js version inside your project directory.
- Use `npx` to temporarily use a specific version of Node.js.
- Use `nodeenv` to create isolated Node.js environments similar to Python’s `venv`.
